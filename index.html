<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Martinho Hoffman â€” PortfÃ³lio</title>
  <meta name="description" content="PortfÃ³lio visual de Martinho Hoffman â€” CiÃªncia de Dados, Python e AWS" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #0b1020;
      --card: #111730;
      --muted: #aab2d5;
      --text: #e8ecff;
      --accent: #7c9bff;
      --pill: #1b2240;
      --line: #233058;
      --good: #2dd4bf;
    }
    * { box-sizing: border-box }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 10% -10%, #1a2146 0%, #0b1020 55%) fixed, var(--bg);
      color: var(--text); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    }
    a { color: var(--accent); text-decoration: none }
    a:hover { text-decoration: underline }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px; }
    header {
      display: grid; grid-template-columns: 1fr; gap: 18px; padding: 20px; border-radius: 16px;
      background: linear-gradient(180deg, rgba(124,155,255,0.08), rgba(124,155,255,0.03));
      border: 1px solid #2b3566;
    }
    @media (min-width: 840px) {
      header { grid-template-columns: 1.2fr 1fr; align-items: center; }
    }
    .title { font-size: clamp(28px, 4vw, 40px); font-weight: 800; letter-spacing: .2px; }
    .headline { color: var(--muted); font-size: 16px; margin-top: 4px }
    .row { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; color: var(--muted); }
    .pill { background: var(--pill); color: #cfe0ff; border: 1px solid #2d3b74; padding: 6px 10px; border-radius: 999px; font-size: 12px; }
    .grid { display: grid; gap: 16px; }
    @media (min-width: 840px){ .grid.cols-2 { grid-template-columns: 1fr 1fr } .grid.cols-3 { grid-template-columns: repeat(3, 1fr) } }
    section { margin-top: 28px }
    h2 { margin: 0 0 12px; font-size: 20px; letter-spacing: .3px }
    .card {
      background: var(--card); border: 1px solid #222a51; border-radius: 14px; padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    .kpi { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
    .kpi .card { text-align: center; }
    .kpi .n { font-weight: 800; font-size: 22px; color: var(--good) }
    .kpi .l { color: var(--muted); font-size: 12px }
    /* Timeline */
    .timeline { position: relative; padding-left: 22px }
    .timeline::before {
      content: ""; position: absolute; left: 8px; top: 0; bottom: 0; width: 2px; background: linear-gradient(var(--line), transparent 90%);
    }
    .t-item { position: relative; margin-bottom: 18px; padding-left: 14px }
    .t-item::before {
      content: ""; position: absolute; left: -6px; top: 6px; width: 12px; height: 12px;
      background: var(--accent); border: 2px solid #0b1020; border-radius: 50%;
      box-shadow: 0 0 0 4px rgba(124,155,255,0.15);
    }
    .t-role { font-weight: 700 }
    .muted { color: var(--muted) }
    /* Lists */
    .badges { display: flex; flex-wrap: wrap; gap: 8px }
    .list { display: grid; gap: 10px }
    .list .item h3 { margin: 0 0 4px; font-size: 15px }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace }
    footer { color: var(--muted); text-align: center; margin: 30px 0 10px }
    .spaced { display: flex; gap: 10px; flex-wrap: wrap }
    .small { font-size: 12px }
    .divider { height: 1px; background: #1a2146; margin: 6px 0 12px }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="card">
      <div>
        <div class="title" id="name">Carregandoâ€¦</div>
        <div class="headline" id="headline"></div>
        <div class="row small" style="margin-top:10px">
          <span id="location" class="pill"></span>
          <a id="email" class="pill" href="#"></a>
          <a id="phone" class="pill" href="#"></a>
          <a class="pill" href="./profile.json" download>Baixar JSON</a>
        </div>
        <p id="summary" style="margin-top:14px"></p>
        <div id="tags" class="badges"></div>
      </div>
      <div class="grid">
        <div class="kpi">
          <div class="card">
            <div class="n" id="kpi-exp">0</div>
            <div class="l">ExperiÃªncias</div>
          </div>
          <div class="card">
            <div class="n" id="kpi-edu">0</div>
            <div class="l">FormaÃ§Ãµes</div>
          </div>
          <div class="card">
            <div class="n" id="kpi-cert">0</div>
            <div class="l">CertificaÃ§Ãµes</div>
          </div>
        </div>
        <div class="card">
          <canvas id="miniChart" height="120"></canvas>
          <div class="small muted" style="margin-top:6px">DistribuiÃ§Ã£o por seÃ§Ã£o</div>
        </div>
      </div>
    </header>

    <section class="grid cols-2">
      <div class="card">
        <h2>ðŸ§ª CompetÃªncias</h2>
        <div id="skills" class="badges"></div>
        <div class="divider"></div>
        <div class="spaced small">
          <div id="languages"></div>
        </div>
      </div>

      <div class="card">
        <h2>ðŸ“… ExperiÃªncia</h2>
        <div id="experience" class="timeline"></div>
      </div>
    </section>

    <section class="grid cols-2">
      <div class="card">
        <h2>ðŸŽ“ EducaÃ§Ã£o</h2>
        <div id="education" class="list"></div>
      </div>
      <div class="card">
        <h2>ðŸ“œ CertificaÃ§Ãµes</h2>
        <div id="certifications" class="list"></div>
      </div>
    </section>

    <footer>
      <div class="small">Ãšltima atualizaÃ§Ã£o: <span id="updated">Agosto 2025</span></div>
    </footer>
  </div>

  <script>
    const $ = (sel) => document.querySelector(sel);
    const el = (tag, cls, text) => {
      const n = document.createElement(tag);
      if (cls) n.className = cls;
      if (text !== undefined) n.textContent = text;
      return n;
    };

    function makePill(text, href) {
      const a = el(href ? 'a' : 'span', 'pill', text);
      if (href) a.href = href;
      return a;
    }

    function normMonth(m) {
      // Normalize months to numeric for sorting if needed (Pt-BR inputs kept as-is for display)
      const map = { jan:1, fev:2, mar:3, abr:4, mai:5, jun:6, jul:7, ago:8, set:9, out:10, nov:11, dez:12 };
      const key = (m || '').toLowerCase().slice(0,3);
      return map[key] || 1;
    }

    function parseDatePt(s) {
      // Accepts "Outubro 2023", "2021", "Mai. 2021", "Atualmente"
      if (!s || /atual/i.test(s)) return { y: 9999, m: 12, raw: s };
      const year = (s.match(/\d{4}/) || [])[0];
      const monToken = s.toLowerCase().match(/^[a-zÃªÃ©Ã­Ã³ÃºÃ£\.]+/);
      let m = 1;
      if (monToken) m = normMonth(monToken[0]);
      return { y: parseInt(year || 1900, 10), m, raw: s };
    }

    function byDateDesc(a, b) {
      const A = parseDatePt(a.end || a.date), B = parseDatePt(b.end || b.date);
      if (A.y !== B.y) return B.y - A.y;
      return B.m - A.m;
    }

    async function main() {
      const res = await fetch('./profile.json');
      const data = await res.json();

      // Header
      $('#name').textContent = data.name || 'â€”';
      $('#headline').textContent = data.headline || '';
      $('#location').textContent = data.location || '';
      if (data.email) { const e = $('#email'); e.textContent = data.email; e.href = 'mailto:' + data.email; }
      if (data.phone) { const p = $('#phone'); p.textContent = data.phone; p.href = 'tel:' + data.phone.replace(/\D/g,''); }
      $('#summary').textContent = data.summary || '';

      // Tags
      const tagsBox = $('#tags');
      (data.tags || []).forEach(t => tagsBox.appendChild(makePill(t)));

      // KPIs
      $('#kpi-exp').textContent = (data.experience || []).length;
      $('#kpi-edu').textContent = (data.education || []).length;
      $('#kpi-cert').textContent = (data.certifications || []).length;

      // Mini Chart
      const ctx = document.getElementById('miniChart');
      const mini = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['ExperiÃªncia','EducaÃ§Ã£o','CertificaÃ§Ãµes'],
          datasets: [{
            data: [ (data.experience||[]).length, (data.education||[]).length, (data.certifications||[]).length ],
            backgroundColor: ['#7c9bff','#2dd4bf','#f59e0b'],
            borderColor: '#0b1020', borderWidth: 2
          }]
        },
        options: {
          plugins: { legend: { labels: { color: '#e8ecff' } } },
          cutout: '62%'
        }
      });

      // Skills
      const skillsBox = $('#skills');
      (data.skills || []).forEach(s => skillsBox.appendChild(makePill(s)));

      // Languages
      const langBox = $('#languages');
      (data.languages || []).forEach(l => langBox.appendChild(makePill(l)));

      // Experience (timeline)
      const expBox = $('#experience');
      (data.experience || []).sort(byDateDesc).forEach(item => {
        const wrap = el('div','t-item');
        const title = el('div','t-role', `${item.title} Â· ${item.company}`);
        const when = el('div','muted small', `${item.start} â€” ${item.end}`);
        const desc = el('div','small', item.description || '');
        wrap.append(title, when, desc);
        expBox.appendChild(wrap);
      });

      // Education
      const eduBox = $('#education');
      (data.education || []).sort(byDateDesc).forEach(ed => {
        const it = el('div','item');
        const h3 = el('h3', null, `${ed.degree} â€” ${ed.school}`);
        const when = el('div','muted small', `${ed.field ? ed.field + ' Â· ' : ''}${ed.start} â€” ${ed.end}`);
        const comps = el('div','spaced small');
        (ed.competencies || []).forEach(c => comps.appendChild(makePill(c)));
        it.append(h3, when, comps);
        eduBox.appendChild(it);
      });

      // Certifications (group issuers -> bar chart + list)
      const certBox = $('#certifications');
      (data.certifications || []).sort(byDateDesc).forEach(c => {
        const it = el('div','item');
        const h3 = el('h3', null, `${c.title} â€” ${c.issuer}`);
        const when = el('div','muted small', c.date || '');
        const comps = el('div','spaced small');
        (c.competencies || []).forEach(k => comps.appendChild(makePill(k)));
        it.append(h3, when, comps);
        certBox.appendChild(it);
      });

      // Optional: small issuer chart below certifications
      const counts = {};
      (data.certifications || []).forEach(c => { counts[c.issuer] = (counts[c.issuer]||0)+1; });
      const issuers = Object.keys(counts);
      if (issuers.length) {
        const chartCard = el('div','card', '');
        chartCard.style.marginTop = '12px';
        const canv = el('canvas'); canv.height = 120;
        chartCard.appendChild(canv);
        certBox.parentElement.appendChild(chartCard);
        new Chart(canv, {
          type: 'bar',
          data: {
            labels: issuers,
            datasets: [{ label: 'CertificaÃ§Ãµes por emissor', data: issuers.map(i => counts[i]), backgroundColor: '#7c9bff' }]
          },
          options: {
            plugins: { legend: { labels: { color: '#e8ecff' } } },
            scales: {
              x: { ticks: { color: '#c8d1ff' }, grid: { color: 'rgba(255,255,255,0.05)' } },
              y: { ticks: { color: '#c8d1ff' }, grid: { color: 'rgba(255,255,255,0.08)' }, beginAtZero: true, precision: 0 }
            }
          }
        });
      }

      // Updated label (fallback to current month/year)
      const now = new Date();
      const meses = ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];
      $('#updated').textContent = `${meses[now.getMonth()]} ${now.getFullYear()}`;
    }

    main().catch(err => {
      console.error(err);
      document.body.innerHTML = '<div class="wrap"><div class="card">Falha ao carregar <code class="mono">profile.json</code>. Verifique se o arquivo estÃ¡ no mesmo diretÃ³rio.</div></div>';
    });
  </script>
</body>
</html>
